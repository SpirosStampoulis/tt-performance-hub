import{u as ee,a as le,r as S,o as te,J as ae,c as P,b as y,E as M,w as t,V as oe,d as i,e as l,f as b,g,h as v,i as s,n as m,B as V,q as ue,s as se,t as d,p as c,v as u,z as I,x as O,y as ne,K as de,l as _,F as N,m as A,I as k,L as H,H as T,M as re,A as B,j as L,N as ie,O as ve}from"./index-BS-_TD4h.js";import{g as pe,u as me}from"./storage-_S1A6rPq.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"text-h4 mb-2"},ye={class:"text-h5 mb-4"},Ve={class:"text-subtitle-1 mt-4"},Se={class:"text-h6"},ge={class:"text-h6"},ke={style:{"white-space":"pre-wrap"}},we={key:1,class:"text-center text-medium-emphasis py-4"},be={class:"video-container"},_e=["src"],he={key:1,class:"text-center text-medium-emphasis py-4"},Ce={class:"text-h4"},xe={__name:"MatchDetail",setup(Me){const F=ae(),p=ee(),z=le(),a=S(null),h=S(!1),C=S(!1),R=S(!1),f=S(0),x=S(""),D=S(!1),w=S({successRate:0,returnPoints:0});te(async()=>{await z.fetchOpponents(),a.value=await p.getMatch(F.params.id),a.value?.serveStats&&(w.value={...a.value.serveStats})});const $=P(()=>{if(!a.value)return"";const n=a.value.scores.reduce((o,r)=>o+r.myScore,0),e=a.value.scores.reduce((o,r)=>o+r.oppScore,0);return n>e?"Win":"Loss"}),j=P(()=>{if(!a.value)return"";const n=a.value.scores.reduce((o,r)=>o+r.myScore,0),e=a.value.scores.reduce((o,r)=>o+r.oppScore,0);return`${n}-${e}`}),W=P(()=>{if(!a.value)return"";const n=z.opponents.find(e=>e.id===a.value.opponentId);return n?n.name:"Unknown"}),U=P(()=>a.value?p.headToHeadStats(a.value.opponentId):{wins:0,losses:0,total:0,winRate:0}),G=async n=>{const e=Array.from(n.target.files);if(e.length!==0){D.value=!0;try{const o=await me(e,`matches/${a.value.id}`),r=[...a.value.photos||[],...o];await p.updateMatch(a.value.id,{...a.value,photos:r}),a.value=await p.getMatch(a.value.id)}catch(o){console.error("Error uploading photos:",o)}finally{D.value=!1,n.target.value=""}}},Y=async n=>{const e=[...a.value.photos];e.splice(n,1),await p.updateMatch(a.value.id,{...a.value,photos:e}),a.value=await p.getMatch(a.value.id)},q=async()=>{if(!x.value)return;const n=[...a.value.videoUrls||[],x.value];await p.updateMatch(a.value.id,{...a.value,videoUrls:n}),a.value=await p.getMatch(a.value.id),h.value=!1,x.value=""},J=async n=>{const e=[...a.value.videoUrls];e.splice(n,1),await p.updateMatch(a.value.id,{...a.value,videoUrls:e}),a.value=await p.getMatch(a.value.id)},K=async()=>{await p.updateMatch(a.value.id,{...a.value,serveStats:w.value}),a.value=await p.getMatch(a.value.id),C.value=!1},Q=n=>{f.value=n,R.value=!0},X=()=>{f.value<a.value.photos.length-1&&f.value++},Z=()=>{f.value>0&&f.value--};return(n,e)=>a.value?(i(),y(oe,{key:0},{default:t(()=>[l(b,null,{default:t(()=>[l(g,null,{default:t(()=>[l(v,{"prepend-icon":"mdi-arrow-left",variant:"text",onClick:e[0]||(e[0]=o=>n.$router.back())},{default:t(()=>[...e[13]||(e[13]=[s(" Back to Matches ",-1)])]),_:1})]),_:1})]),_:1}),l(b,null,{default:t(()=>[l(g,{cols:"12",md:"8"},{default:t(()=>[l(m,{class:"mb-4"},{default:t(()=>[l(V,null,{default:t(()=>[l(b,{align:"center"},{default:t(()=>[l(g,null,{default:t(()=>[l(ue,{color:$.value==="Win"?"success":"error",class:"mr-3"},{default:t(()=>[l(se,null,{default:t(()=>[s(d($.value==="Win"?"mdi-check":"mdi-close"),1)]),_:1})]),_:1},8,["color"]),s(" "+d($.value),1)]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[u("div",ce,"vs "+d(W.value),1),u("div",ye,d(j.value),1),l(I,{class:"mr-2"},{default:t(()=>[s(d(a.value.division),1)]),_:1}),a.value.tournamentName?(i(),y(I,{key:0,class:"mr-2"},{default:t(()=>[s(d(a.value.tournamentName),1)]),_:1})):M("",!0),u("div",Ve,d(O(ne)(a.value.date)),1)]),_:1})]),_:1}),l(m,{class:"mb-4"},{default:t(()=>[l(V,null,{default:t(()=>[...e[14]||(e[14]=[s("Set Breakdown",-1)])]),_:1}),l(c,null,{default:t(()=>[l(de,null,{default:t(()=>[e[15]||(e[15]=u("thead",null,[u("tr",null,[u("th",null,"Set"),u("th",null,"My Score"),u("th",null,"Opponent Score"),u("th",null,"Result")])],-1)),u("tbody",null,[(i(!0),_(N,null,A(a.value.scores,o=>(i(),_("tr",{key:o.set},[u("td",null,d(o.set),1),u("td",null,d(o.myScore),1),u("td",null,d(o.oppScore),1),u("td",null,[l(I,{color:o.myScore>o.oppScore?"success":"error",size:"small"},{default:t(()=>[s(d(o.myScore>o.oppScore?"Won":"Lost"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})]),_:1}),a.value.serveStats?(i(),y(m,{key:0,class:"mb-4"},{default:t(()=>[l(V,null,{default:t(()=>[...e[16]||(e[16]=[s("Serve & Return Statistics",-1)])]),_:1}),l(c,null,{default:t(()=>[l(b,null,{default:t(()=>[l(g,{cols:"6"},{default:t(()=>[u("div",Se,d(a.value.serveStats.successRate||0)+"%",1),e[17]||(e[17]=u("div",{class:"text-caption"},"Serve Success Rate",-1))]),_:1}),l(g,{cols:"6"},{default:t(()=>[u("div",ge,d(a.value.serveStats.returnPoints||0),1),e[18]||(e[18]=u("div",{class:"text-caption"},"Return Points Won",-1))]),_:1})]),_:1}),l(v,{size:"small","prepend-icon":"mdi-pencil",class:"mt-2",onClick:e[1]||(e[1]=o=>C.value=!0)},{default:t(()=>[...e[19]||(e[19]=[s(" Edit Stats ",-1)])]),_:1})]),_:1})]),_:1})):M("",!0),a.value.notes?(i(),y(m,{key:1,class:"mb-4"},{default:t(()=>[l(V,null,{default:t(()=>[...e[20]||(e[20]=[s("Match Notes",-1)])]),_:1}),l(c,null,{default:t(()=>[u("p",ke,d(a.value.notes),1)]),_:1})]),_:1})):M("",!0),l(m,{class:"mb-4"},{default:t(()=>[l(V,null,{default:t(()=>[e[22]||(e[22]=s(" Photos ",-1)),l(k),l(v,{"prepend-icon":"mdi-camera",size:"small",onClick:e[2]||(e[2]=o=>n.$refs.photoInput.click())},{default:t(()=>[...e[21]||(e[21]=[s(" Add Photos ",-1)])]),_:1}),u("input",{ref:"photoInput",type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:G},null,544)]),_:1}),l(c,null,{default:t(()=>[a.value.photos&&a.value.photos.length>0?(i(),y(b,{key:0},{default:t(()=>[(i(!0),_(N,null,A(a.value.photos,(o,r)=>(i(),y(g,{key:r,cols:"6",md:"4"},{default:t(()=>[l(m,null,{default:t(()=>[l(H,{src:o,"aspect-ratio":"1",cover:"",onClick:E=>Q(r)},null,8,["src","onClick"]),l(T,null,{default:t(()=>[l(k),l(v,{icon:"mdi-delete",size:"small",onClick:E=>Y(r)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(i(),_("div",we," No photos added yet "))]),_:1})]),_:1}),l(m,null,{default:t(()=>[l(V,null,{default:t(()=>[e[24]||(e[24]=s(" Videos ",-1)),l(k),l(v,{"prepend-icon":"mdi-video-plus",size:"small",onClick:e[3]||(e[3]=o=>h.value=!0)},{default:t(()=>[...e[23]||(e[23]=[s(" Add Video ",-1)])]),_:1})]),_:1}),l(c,null,{default:t(()=>[a.value.videoUrls&&a.value.videoUrls.length>0?(i(),y(b,{key:0},{default:t(()=>[(i(!0),_(N,null,A(a.value.videoUrls,(o,r)=>(i(),y(g,{key:r,cols:"12",md:"6"},{default:t(()=>[u("div",be,[u("iframe",{src:O(pe)(o),frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,_e)]),l(v,{block:"",size:"small","prepend-icon":"mdi-delete",class:"mt-2",onClick:E=>J(r)},{default:t(()=>[...e[25]||(e[25]=[s(" Remove Video ",-1)])]),_:1},8,["onClick"])]),_:2},1024))),128))]),_:1})):(i(),_("div",he," No videos added yet "))]),_:1})]),_:1})]),_:1}),l(g,{cols:"12",md:"4"},{default:t(()=>[l(m,null,{default:t(()=>[l(V,null,{default:t(()=>[s("Head-to-Head vs "+d(W.value),1)]),_:1}),l(c,null,{default:t(()=>[u("div",Ce,d(U.value.wins)+"-"+d(U.value.losses),1),e[27]||(e[27]=u("div",{class:"text-caption mb-4"},"Win-Loss Record",-1)),l(re,{"model-value":U.value.winRate,color:"primary",height:"20",class:"mb-2"},{default:t(()=>[u("strong",null,d(U.value.winRate)+"%",1)]),_:1},8,["model-value"]),l(v,{block:"",variant:"outlined",to:`/opponents/${a.value.opponentId}`,class:"mt-4"},{default:t(()=>[...e[26]||(e[26]=[s(" View Opponent Profile ",-1)])]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})]),_:1}),l(B,{modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=o=>h.value=o),"max-width":"500"},{default:t(()=>[l(m,null,{default:t(()=>[l(V,null,{default:t(()=>[...e[28]||(e[28]=[s("Add Video URL",-1)])]),_:1}),l(c,null,{default:t(()=>[l(L,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=o=>x.value=o),label:"YouTube URL",placeholder:"https://www.youtube.com/watch?v=...",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(T,null,{default:t(()=>[l(k),l(v,{text:"",onClick:e[5]||(e[5]=o=>h.value=!1)},{default:t(()=>[...e[29]||(e[29]=[s("Cancel",-1)])]),_:1}),l(v,{color:"primary",onClick:q},{default:t(()=>[...e[30]||(e[30]=[s("Add",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=o=>C.value=o),"max-width":"500"},{default:t(()=>[l(m,null,{default:t(()=>[l(V,null,{default:t(()=>[...e[31]||(e[31]=[s("Edit Serve & Return Stats",-1)])]),_:1}),l(c,null,{default:t(()=>[l(L,{modelValue:w.value.successRate,"onUpdate:modelValue":e[7]||(e[7]=o=>w.value.successRate=o),modelModifiers:{number:!0},label:"Serve Success Rate (%)",type:"number",variant:"outlined"},null,8,["modelValue"]),l(L,{modelValue:w.value.returnPoints,"onUpdate:modelValue":e[8]||(e[8]=o=>w.value.returnPoints=o),modelModifiers:{number:!0},label:"Return Points Won",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(T,null,{default:t(()=>[l(k),l(v,{text:"",onClick:e[9]||(e[9]=o=>C.value=!1)},{default:t(()=>[...e[32]||(e[32]=[s("Cancel",-1)])]),_:1}),l(v,{color:"primary",onClick:K},{default:t(()=>[...e[33]||(e[33]=[s("Save",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:R.value,"onUpdate:modelValue":e[12]||(e[12]=o=>R.value=o),fullscreen:""},{default:t(()=>[l(m,null,{default:t(()=>[l(ie,null,{default:t(()=>[l(v,{icon:"mdi-close",onClick:e[11]||(e[11]=o=>R.value=!1)}),l(ve,null,{default:t(()=>[...e[34]||(e[34]=[s("Photo Gallery",-1)])]),_:1})]),_:1}),l(c,{class:"d-flex align-center justify-center",style:{height:"100%"}},{default:t(()=>[a.value.photos&&a.value.photos[f.value]?(i(),y(H,{key:0,src:a.value.photos[f.value],contain:"","max-height":"90vh"},null,8,["src"])):M("",!0)]),_:1}),l(T,null,{default:t(()=>[l(v,{icon:"mdi-chevron-left",onClick:Z,disabled:f.value===0},null,8,["disabled"]),l(k),u("div",null,d(f.value+1)+" / "+d(a.value.photos?.length||0),1),l(k),l(v,{icon:"mdi-chevron-right",onClick:X,disabled:f.value===(a.value.photos?.length||0)-1},null,8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):M("",!0)}},Te=fe(xe,[["__scopeId","data-v-b3f09e85"]]);export{Te as default};
