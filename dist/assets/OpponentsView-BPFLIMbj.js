import{a as Q,u as R,r as u,o as J,c as K,b as S,w as t,V as W,d as c,e as a,f as C,g as p,h as r,i as s,j as k,k as B,l as T,F as X,m as Y,n as x,p as O,q as Z,L as ee,t as m,v as U,z as le,H as D,P as $,I as _,A as z,B as L,C as ae,Q as te,G as oe}from"./index-BS-_TD4h.js";import{a as ne}from"./storage-_S1A6rPq.js";const ue={key:1,class:"text-h5"},se={class:"text-h6"},re={class:"text-caption mt-2"},ie={class:"text-caption text-medium-emphasis"},ve={__name:"OpponentsView",setup(de){const v=Q(),A=R(),V=u(!1),f=u(!1),i=u(null),b=u(null),g=u(""),y=u(null),F=u(null),d=u(null),w=u(!1),n=u({name:"",playingStyle:"",club:"",notes:"",photoUrl:""});J(async()=>{await Promise.all([v.fetchOpponents(),A.fetchMatches()])});const h=K(()=>{let o=v.opponents;if(g.value){const e=g.value.toLowerCase();o=o.filter(l=>l.name.toLowerCase().includes(e)||l.club?.toLowerCase().includes(e))}return y.value&&(o=o.filter(e=>e.playingStyle===y.value)),o}),M=(o=null)=>{o?(i.value=o,n.value={...o}):(i.value=null,n.value={name:"",playingStyle:"",club:"",notes:"",photoUrl:""}),d.value=null,V.value=!0},N=()=>{V.value=!1,i.value=null},I=async()=>{const{valid:o}=await F.value.validate();if(o){w.value=!0;try{let e=n.value.photoUrl;d.value&&d.value.length>0&&(e=await ne(d.value[0],"opponents"));const l={...n.value,photoUrl:e};i.value?await v.updateOpponent(i.value.id,l):await v.addOpponent(l),N()}catch(e){console.error("Error saving opponent:",e)}finally{w.value=!1}}},E=o=>{b.value=o,f.value=!0},q=async()=>{try{await v.deleteOpponent(b.value.id),f.value=!1,b.value=null}catch(o){console.error("Error deleting opponent:",o)}},j=o=>o.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),G=o=>({Aggressive:"error",Defensive:"success",Mixed:"info"})[o]||"grey",H=o=>A.getMatchesByOpponent(o).length;return(o,e)=>(c(),S(W,null,{default:t(()=>[a(C,{class:"mb-4"},{default:t(()=>[a(p,null,{default:t(()=>[a(r,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=l=>M())},{default:t(()=>[...e[11]||(e[11]=[s(" Add Opponent ",-1)])]),_:1})]),_:1})]),_:1}),a(C,null,{default:t(()=>[a(p,{cols:"12",md:"6"},{default:t(()=>[a(k,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),"prepend-inner-icon":"mdi-magnify",label:"Search opponents",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),a(p,{cols:"12",md:"6"},{default:t(()=>[a(B,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l),items:["Aggressive","Defensive","Mixed"],label:"Filter by Playing Style",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(C,null,{default:t(()=>[(c(!0),T(X,null,Y(h.value,l=>(c(),S(p,{key:l.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[a(x,{hover:"",onClick:P=>o.$router.push(`/opponents/${l.id}`)},{default:t(()=>[a(O,null,{default:t(()=>[a(C,{align:"center"},{default:t(()=>[a(p,{cols:"auto"},{default:t(()=>[a(Z,{size:"80",color:l.photoUrl?void 0:"primary"},{default:t(()=>[l.photoUrl?(c(),S(ee,{key:0,src:l.photoUrl},null,8,["src"])):(c(),T("span",ue,m(j(l.name)),1))]),_:2},1032,["color"])]),_:2},1024),a(p,null,{default:t(()=>[U("div",se,m(l.name),1),a(le,{size:"small",class:"mr-1",color:G(l.playingStyle)},{default:t(()=>[s(m(l.playingStyle),1)]),_:2},1032,["color"]),U("div",re,m(l.club||"No club"),1),U("div",ie,m(H(l.id))+" matches ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(D,null,{default:t(()=>[a(r,{icon:"mdi-pencil",size:"small",onClick:$(P=>M(l),["stop"])},null,8,["onClick"]),a(r,{icon:"mdi-delete",size:"small",color:"error",onClick:$(P=>E(l),["stop"])},null,8,["onClick"]),a(_),a(r,{"append-icon":"mdi-arrow-right",variant:"text"},{default:t(()=>[...e[12]||(e[12]=[s("View Profile",-1)])]),_:1})]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),a(z,{modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=l=>V.value=l),"max-width":"600",persistent:""},{default:t(()=>[a(x,null,{default:t(()=>[a(L,null,{default:t(()=>[s(m(i.value?"Edit Opponent":"Add New Opponent"),1)]),_:1}),a(O,null,{default:t(()=>[a(ae,{ref_key:"opponentForm",ref:F},{default:t(()=>[a(k,{modelValue:n.value.name,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value.name=l),label:"Name",variant:"outlined",rules:[l=>!!l||"Name is required"]},null,8,["modelValue","rules"]),a(B,{modelValue:n.value.playingStyle,"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.playingStyle=l),items:["Aggressive","Defensive","Mixed"],label:"Playing Style",variant:"outlined",rules:[l=>!!l||"Playing style is required"]},null,8,["modelValue","rules"]),a(k,{modelValue:n.value.club,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.club=l),label:"Club / Organization",variant:"outlined"},null,8,["modelValue"]),a(te,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=l=>d.value=l),label:"Profile Photo",variant:"outlined",accept:"image/*","prepend-icon":"","prepend-inner-icon":"mdi-camera",clearable:!0},null,8,["modelValue"]),a(oe,{modelValue:n.value.notes,"onUpdate:modelValue":e[7]||(e[7]=l=>n.value.notes=l),label:"Notes",variant:"outlined",rows:"3"},null,8,["modelValue"])]),_:1},512)]),_:1}),a(D,null,{default:t(()=>[a(_),a(r,{text:"",onClick:N},{default:t(()=>[...e[13]||(e[13]=[s("Cancel",-1)])]),_:1}),a(r,{color:"primary",onClick:I,loading:w.value},{default:t(()=>[...e[14]||(e[14]=[s("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value=l),"max-width":"400"},{default:t(()=>[a(x,null,{default:t(()=>[a(L,null,{default:t(()=>[...e[15]||(e[15]=[s("Delete Opponent",-1)])]),_:1}),a(O,null,{default:t(()=>[...e[16]||(e[16]=[s(" Are you sure you want to delete this opponent? This action cannot be undone. ",-1)])]),_:1}),a(D,null,{default:t(()=>[a(_),a(r,{text:"",onClick:e[9]||(e[9]=l=>f.value=!1)},{default:t(()=>[...e[17]||(e[17]=[s("Cancel",-1)])]),_:1}),a(r,{color:"error",onClick:q},{default:t(()=>[...e[18]||(e[18]=[s("Delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ve as default};
